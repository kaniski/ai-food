{% extends "base.html" %}
{% block content %}
  <div class="hero">
    <div class="eyebrow">Direção do plano</div>
    <h1>Agora vamos calibrar seu objetivo e sua rotina.</h1>
    <p class="sub">
      Com isso, calculamos suas metas diárias (calorias e macros) antes de montar o cardápio.
    </p>
  </div>

  <form method="post" class="form">
    <input type="hidden" name="csrf" value="{{ csrf_token }}">

    <div class="q">
      <div class="q-title">Seu objetivo é:</div>
      <div class="choices">
        <label class="chip">
          <input type="radio" name="objetivo" value="emagrecer" {% if values.objetivo == 'emagrecer' %}checked{% endif %}>
          <span>Emagrecer</span>
        </label>
        <label class="chip">
          <input type="radio" name="objetivo" value="manter" {% if values.objetivo == 'manter' %}checked{% endif %}>
          <span>Manter</span>
        </label>
        <label class="chip">
          <input type="radio" name="objetivo" value="ganhar_massa" {% if values.objetivo == 'ganhar_massa' %}checked{% endif %}>
          <span>Ganhar massa</span>
        </label>
        <label class="chip">
          <input type="radio" name="objetivo" value="engordar" {% if values.objetivo == 'engordar' %}checked{% endif %}>
          <span>Engordar</span>
        </label>
      </div>
      {% if errors.get('objetivo') %}<div class="err">{{ errors.get('objetivo') }}</div>{% endif %}
    </div>

    <div class="grid" style="margin-top:14px;">
      <div class="field">
        <label>Sexo</label>
        <select name="sexo">
          {% set s = values.sexo %}
          <option value="masculino" {% if s == 'masculino' %}selected{% endif %}>Masculino</option>
          <option value="feminino" {% if s == 'feminino' %}selected{% endif %}>Feminino</option>
        </select>
        {% if errors.get('sexo') %}<div class="err">{{ errors.get('sexo') }}</div>{% endif %}
      </div>

      <div class="field">
        <label>Altura (cm)</label>
        <input name="altura_cm" type="number" min="120" max="230" placeholder="Ex: 175" value="{{ values.altura_cm }}">
        {% if errors.get('altura_cm') %}<div class="err">{{ errors.get('altura_cm') }}</div>{% endif %}
      </div>

      <div class="field">
        <label>Nível de atividade</label>
        <select name="atividade">
          {% set a = values.atividade %}
          <option value="sedentario" {% if a == 'sedentario' %}selected{% endif %}>Sedentário</option>
          <option value="leve" {% if a == 'leve' %}selected{% endif %}>Leve (caminhadas, rotina ativa)</option>
          <option value="moderado" {% if a == 'moderado' %}selected{% endif %}>Moderado (treina 3–4x/sem)</option>
          <option value="alto" {% if a == 'alto' %}selected{% endif %}>Alto (treina 5–6x/sem)</option>
          <option value="muito_alto" {% if a == 'muito_alto' %}selected{% endif %}>Muito alto (trabalho pesado + treino)</option>
        </select>
        {% if errors.get('atividade') %}<div class="err">{{ errors.get('atividade') }}</div>{% endif %}
      </div>

      <div class="field">
        <label>Refeições por dia</label>
        <select name="refeicoes_por_dia">
          {% set r = values.refeicoes_por_dia %}
          <option value="2" {% if r == 2 or r == '2' %}selected{% endif %}>2</option>
          <option value="3" {% if r == 3 or r == '3' %}selected{% endif %}>3</option>
          <option value="4" {% if r == 4 or r == '4' %}selected{% endif %}>4</option>
          <option value="5" {% if r == 5 or r == '5' %}selected{% endif %}>5</option>
          <option value="6" {% if r == 6 or r == '6' %}selected{% endif %}>6</option>
        </select>
        {% if errors.get('refeicoes_por_dia') %}<div class="err">{{ errors.get('refeicoes_por_dia') }}</div>{% endif %}
      </div>
    </div>

    <div class="actions">
      <a class="btn ghost" href="/step/2">Voltar</a>
      <button class="btn primary" type="submit">Calcular minhas metas</button>
    </div>

    <div class="mini">
      Próximo passo: você verá suas metas diárias (calorias e macros) divididas por refeição.
    </div>
  </form>
{% endblock %}
